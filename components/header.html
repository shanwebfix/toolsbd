<header>
  <head>
  <script>
    (function () {
      try {
        const theme = localStorage.getItem('theme');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        if (theme === 'dark' || (!theme && prefersDark)) {
          document.documentElement.classList.add('dark-mode');
        }
      } catch (e) {
        console.error('Theme preload error:', e);
      }
    })();
  </script>
  </head>
  
  <div class="header-container">
    <button class="mobile-back-btn" id="mobileBackBtn" aria-label="Go back">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M19 12H5M12 19l-7-7 7-7"/>
      </svg>
    </button>
    
    <div class="logo">
      <a href="/"><img src="/assets/logo.png" alt="ToolsBD" /></a>
    </div>

    <!-- Desktop Nav -->
    <nav class="nav-menu" id="navMenu">
      <ul>
        <li><a href="index.html">Home</a></li>
        <li><a href="about.html">Blog</a></li>
        <li><a href="about.html">About</a></li>
        <li><a href="services.html">Services</a></li>
        <li><a href="contact.html">Contact</a></li>
        <li class="desktop-toggle">
          <label class="theme-switch" title="Toggle Dark Mode">
            <input type="checkbox" class="toggle-theme" id="toggleThemeDesktop" />
            <span class="slider"></span>
          </label>
        </li>
      </ul>
    </nav>

    <div class="menu-group">
      <div class="menu-toggle" id="menuToggle"><i class="fas fa-list"></i></div>
    </div>
  </div>

  <!-- Mobile Full Canvas -->
  <div id="mobileCanvas" class="mobile-canvas">
    <div class="canvas-header">
      <h2><img src="/assets/logo.png" alt="ToolsBD" height="20px" /></h2>
      <button id="closeCanvas" title="Close Menu">&times;</button>
    </div>

    <div class="canvas-content">
      <!-- Section: Menu -->
      <section class="canvas-section">
        <div class="section-header">
          <h3>Menu</h3>
        </div>
        <nav class="canvas-nav">
          <ul>
            <li><a href="index.html" class="canvas-link">Home</a></li>
            <li><a href="about.html" class="canvas-link">Blog</a></li>
            <li><a href="about.html" class="canvas-link">About</a></li>
            <li><a href="services.html" class="canvas-link">Services</a></li>
            <li><a href="contact.html" class="canvas-link">Contact</a></li>
          </ul>
        </nav>
      </section>

      <!-- Section: Settings -->
      <section class="canvas-section">
        <div class="section-header">
          <h3>Settings</h3>
        </div>

        <nav class="canvas-nav">
          <ul>
            <li class="setting-item">
              <span class="setting-label">Dark Mode</span>
              <label class="theme-switch" title="Toggle Dark Mode">
                <input type="checkbox" class="toggle-theme" id="toggleThemeMobile" />
                <span class="slider"></span>
              </label>
            </li>
            <li><a href="index.html" class="canvas-link">Profile</a></li>
            <li><a href="about.html" class="canvas-link">Deshboard</a></li>
            <li><a href="services.html" class="canvas-link">Information</a></li>
          </ul>
        </nav>
      </section>

      <!-- Section: Others -->
      <section class="canvas-section">
        <div class="section-header">
          <h3>Others</h3>
          <button class="section-btn" title="More Options">⚙️</button>
        </div>
        <nav class="canvas-nav">
          <ul>
            <li><a href="faq.html" class="canvas-link">Faq</a></li>
            <li><a href="feedback.html" class="canvas-link">Feedback</a></li>
            <li><a href="rules.html" class="canvas-link">Rules</a></li>
            <li><a href="privacy.html" class="canvas-link">Privacy & Policy</a></li>
          </ul>
        </nav>
      </section>
    </div>
  </div>
</header>

<script>
// Robust back button implementation
(function() {
  // Wait for DOM to be fully loaded
  document.addEventListener('DOMContentLoaded', function() {
    const backBtn = document.getElementById('mobileBackBtn');
    
    if (backBtn) {
      backBtn.addEventListener('click', function(e) {
        e.preventDefault();
        console.log('Back button clicked'); // For debugging
        
        try {
          if (window.history && window.history.length > 1) {
            window.history.back();
          } else {
            // Fallback for when there's no history
            window.location.href = document.referrer || '/';
          }
        } catch (error) {
          console.error('Back navigation failed:', error);
          window.location.href = '/'; // Ultimate fallback
        }
      });
    } else {
      console.warn('Back button element not found');
    }
  });
})();
</script>